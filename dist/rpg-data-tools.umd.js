(function(a,r){typeof exports=="object"&&typeof module<"u"?r(exports,require("@sigureya/rpgtypes")):typeof define=="function"&&define.amd?define(["exports","@sigureya/rpgtypes"],r):(a=typeof globalThis<"u"?globalThis:a||self,r(a.RpgDataTools={},a.rpgtypes))})(this,function(a,r){"use strict";const m=()=>[0,0,0,0,0,0,0,0],D=e=>({id:0,name:"",nickname:"",profile:"",note:"",classId:0,initialLevel:1,maxLevel:99,characterIndex:0,characterName:"",faceIndex:0,faceName:"",battlerName:"",traits:[],equips:[],...e}),k=e=>({battlerHue:0,id:0,name:"",note:"",battlerName:"",traits:[],params:m(),exp:0,gold:0,dropItems:[],actions:[],...e}),p=e=>({price:0,id:0,name:"",note:"",iconIndex:0,description:"",etypeId:0,params:m(),traits:[],...e}),R=e=>({price:0,id:0,name:"",note:"",iconIndex:0,description:"",etypeId:0,wtypeId:0,params:m(),traits:[],damage:d(),...e}),V=e=>({id:0,name:"",note:"",traits:[],learnings:[],params:m(),expParams:[],...e}),d=e=>({type:0,elementId:0,formula:"0",variance:20,critical:!1,...e}),F=e=>({id:0,name:"",iconIndex:0,description:"",note:"",price:0,consumable:!1,scope:0,occasion:0,speed:0,successRate:100,repeats:1,tpGain:0,hitType:0,animationId:0,damage:d(),effects:[],...e}),B=e=>({animationId:0,damage:d(),description:"",hitType:0,iconIndex:0,id:0,message1:"",message2:"",mpCost:0,name:"",note:"",occasion:0,repeats:1,requiredWtypeId1:0,requiredWtypeId2:0,scope:0,speed:0,stypeId:0,successRate:100,tpCost:0,tpGain:0,effects:[],messageType:0,...e}),x=e=>({id:0,name:"",iconIndex:0,restriction:0,priority:50,motion:0,overlay:0,removeAtBattleEnd:!1,removeByRestriction:!1,autoRemovalTiming:0,minTurns:1,maxTurns:1,removeByDamage:!1,chanceByDamage:100,removeByWalking:!1,stepsToRemove:100,message1:"",message2:"",message3:"",message4:"",traits:[],note:"",...e}),H=e=>({autoplayBgm:!0,autoplayBgs:!1,battleback1Name:"",battleback2Name:"",data:[],disableDashing:!1,displayName:"",encounterList:[],events:[],height:0,note:"",width:0,x:0,y:0,parallaxName:"",parallaxLoopX:!1,parallaxLoopY:!1,parallaxShow:!1,parallaxSx:0,parallaxSy:0,...e}),G=e=>({id:0,name:"",note:"",x:0,y:0,pages:[b()],...e}),h=e=>({actorId:0,actorValid:!1,itemId:0,itemValid:!1,selfSwitchCh:"",selfSwitchValid:!1,switch1Id:0,switch1Valid:!1,switch2Id:0,switch2Valid:!1,variableId:0,variableValid:!1,variableValue:0,...e}),v=e=>({characterIndex:0,characterName:"",direction:6,pattern:0,tileId:0,...e}),b=e=>({conditions:h(),image:v(),moveRoute:{list:[],repeat:!1,wait:!1,skippable:!1},directionFix:!1,moveFrequency:0,list:[],...e}),n=()=>({name:"",pan:0,pitch:100,volume:90}),L=(e={})=>({local:e.local??"",gameTitle:e.gameTitle??"",currencyUnit:e.currencyUnit??"",title1Name:e.title1Name??"",terms:e.terms??I(),title2Name:e.title2Name??"",optAutosave:e.optAutosave??!1,attackMotions:e.attackMotions??[],startMapId:e.startMapId??0,startX:e.startX??0,startY:e.startY??0,switches:e.switches??[],windowTone:e.windowTone??[0,0,0,0],editMapId:e.editMapId??0,testTroopId:e.testTroopId??0,testBattlers:e.testBattlers??[],versionId:e.versionId??0,advanced:e.advanced??S(),armorTypes:e.armorTypes??[],elements:e.elements??[],variables:e.variables??[],equipTypes:e.equipTypes??[],sounds:e.sounds??w(),titleBgm:e.titleBgm??n(),gameoverMe:e.gameoverMe??n(),battleBgm:e.battleBgm??n(),defeatMe:e.defeatMe??n(),victoryMe:e.victoryMe??n(),battleback1Name:e.battleback1Name??"",battleback2Name:e.battleback2Name??"",battlerName:e.battlerName??"",weaponTypes:e.weaponTypes??[],skillTypes:e.skillTypes??[],optDisplayTp:e.optDisplayTp??!1,optDrawTitle:e.optDrawTitle??!1,optExtraExp:e.optExtraExp??!1,optFloorDeath:e.optFloorDeath??!1,optFollowers:e.optFollowers??!1,optKeyItemsNumber:e.optKeyItemsNumber??!1,optSideView:e.optSideView??!1,optSlipDeath:e.optSlipDeath??!1,optTransparent:e.optTransparent??!1,boat:e.boat??o(),ship:e.ship??o(),airship:e.airship??o(),tileSize:e.tileSize??0}),I=(e={})=>({messages:A(e.messages??{}),commands:T(e.commands??{}),params:y(e.params??{}),basic:N(e.basic??{})}),N=(e={})=>[e.level??"",e.levelA??"",e.hp??"",e.hpA??"",e.mp??"",e.mpA??"",e.tp??"",e.tpA??"",e.experience??"",e.exp??""],y=(e={})=>[e.mhp??"",e.mmp??"",e.atk??"",e.def??"",e.mat??"",e.mdf??"",e.agi??"",e.luk??"",e.hit??"",e.eva??""],T=(e={})=>[e.fight??"",e.escape??"",e.attack??"",e.guard??"",e.item??"",e.skill??"",e.equip??"",e.status??"",e.formation??"",e.save??"",e.gameEnd??"",e.options??"",e.weapon??"",e.armor??"",e.keyItem??"",e.equip2??"",e.optimize??"",e.clear??"",e.newGame??"",e.continue_??"",e.notUsed20??"",e.toTitle??"",e.cancel??"",e.notUsed23??"",e.buy??"",e.sell??""],A=(e={})=>({alwaysDash:e.alwaysDash??"",commandRemember:e.commandRemember??"",touchUI:e.touchUI??"",bgmVolume:e.bgmVolume??"",bgsVolume:e.bgsVolume??"",meVolume:e.meVolume??"",seVolume:e.seVolume??"",possession:e.possession??"",expTotal:e.expTotal??"",expNext:e.expNext??"",saveMessage:e.saveMessage??"",loadMessage:e.loadMessage??"",file:e.file??"",autosave:e.autosave??"",partyName:e.partyName??"",emerge:e.emerge??"",preemptive:e.preemptive??"",surprise:e.surprise??"",escapeStart:e.escapeStart??"",escapeFailure:e.escapeFailure??"",victory:e.victory??"",defeat:e.defeat??"",obtainExp:e.obtainExp??"",obtainGold:e.obtainGold??"",obtainItem:e.obtainItem??"",levelUp:e.levelUp??"",obtainSkill:e.obtainSkill??"",useItem:e.useItem??"",criticalToEnemy:e.criticalToEnemy??"",criticalToActor:e.criticalToActor??"",actorDamage:e.actorDamage??"",actorRecovery:e.actorRecovery??"",actorGain:e.actorGain??"",actorLoss:e.actorLoss??"",actorDrain:e.actorDrain??"",actorNoDamage:e.actorNoDamage??"",actorNoHit:e.actorNoHit??"",enemyDamage:e.enemyDamage??"",enemyRecovery:e.enemyRecovery??"",enemyGain:e.enemyGain??"",enemyLoss:e.enemyLoss??"",enemyDrain:e.enemyDrain??"",enemyNoDamage:e.enemyNoDamage??"",enemyNoHit:e.enemyNoHit??"",evasion:e.evasion??"",magicEvasion:e.magicEvasion??"",magicReflection:e.magicReflection??"",counterAttack:e.counterAttack??"",substitute:e.substitute??"",buffAdd:e.buffAdd??"",debuffAdd:e.debuffAdd??"",buffRemove:e.buffRemove??"",actionFailure:e.actionFailure??""}),S=(e={})=>({gameId:e.gameId??0,screenWidth:e.screenWidth??0,screenHeight:e.screenHeight??0,uiAreaWidth:e.uiAreaWidth??0,uiAreaHeight:e.uiAreaHeight??0,windowOpacity:e.windowOpacity??0,screenScale:e.screenScale??0,numberFontFilename:e.numberFontFilename??"",mainFontFilename:e.mainFontFilename??"",fallbackFonts:e.fallbackFonts??"",fontSize:e.fontSize??0}),o=(e={})=>({bgm:e.bgm??n(),characterIndex:e.characterIndex??0,characterName:e.characterName??"",startMapId:e.startMapId??0,startX:e.startX??0,startY:e.startY??0}),w=(e={})=>[e.cursor??n(),e.ok??n(),e.cancel??n(),e.buzzer??n(),e.equip??n(),e.save??n(),e.load??n(),e.battleStart??n(),e.escape??n(),e.enemyAttack??n(),e.enemyDamage??n(),e.enemyCollapse??n(),e.bossCollapse1??n(),e.bossCollapse2??n(),e.actorDamage??n(),e.actorCollapse??n(),e.playRecovery??n(),e.playMiss??n(),e.playEvasion??n(),e.playMagicEvasion??n(),e.playReflection??n(),e.shop??n(),e.useItem??n(),e.useSkill??n()];class C{constructor(t,c,i){this.command=t,this.index=c,this.array=i}joinBody(t=`
`){return this.body().map(c=>c.parameters[0]).join(t)}body(){const t=[];for(let c=this.index+1;c<this.array.length;c++){const i=this.array[c];if(i.code===401)t.push(i);else break}return t}head(){return this.command}speakerName(){return this.command.parameters[4]}}const O=(e,t)=>e.map((c,i,s)=>{switch(c.code){case r.SHOW_MESSAGE:return t.showMessage(new C(c,i,s));case r.SHOW_CHOICES:return t.showChoices(c,i,s);case r.SHOW_CHOICES_ITEM:return t.showChoicesItem(c,i,s);case r.SHOW_SCROLLING_TEXT:return t.showscrollingText(c,i,s);case r.CHANGE_NAME:return t.changeName(c,i,s);case r.CHANGE_PROFILE:return t.changeProfile(c,i,s);case r.CHANGE_NICKNAME:return t.changeNickname(c,i,s);case r.COMMENT_BODY:return t.commentBody(c,i,s);default:return t.other(c,i,s)}}),f=(e,t)=>`<${e}:${t}>`,u=()=>/<([^<>:]+):([^>]*)>/g,W=e=>{const t=u(),c=[];let i;for(;(i=t.exec(e))!==null;)c.push([i[1],i[2]]);return c},P=(e,t)=>e.replace(u(),(c,i,s)=>{const l=t(i,s);return f(i,l)}),_=(e,t)=>{const c=u();let i;for(;(i=c.exec(e))!==null;)if(i[1]===t)return i[2]},q=(e,t,c)=>{const i=u();return e.replace(i,(s,l,M)=>l===t?f(l,c):s)},z=e=>`code:${e}`,U="N",X="V",g=(e,t)=>`\\${e}[${t}]`,E=e=>g(U,e.id),Y=e=>e.map(t=>({controlChar:E(t),text:t.name})),$=e=>e.variables.map((t,c)=>({text:t||"",controlChar:g(X,c)})).filter(t=>t.text!==""),j=new Set(["px","py","x","y","v","n","p","g","c","i","fs"]),K=(e,t=j)=>{const c=/\\([A-Za-z]+)\[(\d+)]/g,i=[];let s;for(;(s=c.exec(e))!==null;){const l=s[1].toLowerCase(),M=parseInt(s[2],10);t.has(l)&&i.push({char:s[1],id:M})}return i};a.MessageProxy=C,a.codeInfoText=z,a.constructActor=D,a.constructArmor=p,a.constructClass=V,a.constructDamage=d,a.constructEnemy=k,a.constructItem=F,a.constructParamArray=m,a.constructSkill=B,a.constructState=x,a.constructWeapon=R,a.createAdvanced=S,a.createAudio=n,a.createBasicTerms=N,a.createCommandsArray=T,a.createCondtion=h,a.createControlCharFormat=g,a.createEventPage=b,a.createMap=H,a.createMapEvent=G,a.createMapEventImage=v,a.createMessages=A,a.createNoteEntity=f,a.createParamNamesArray=y,a.createSystemData=L,a.createSystemSoundsArray=w,a.createTerms=I,a.createVehicle=o,a.fromActor=E,a.fromActors=Y,a.fromSystem=$,a.getControlChars=K,a.getNoteValue=_,a.makeRegex=u,a.mapTextCommand=O,a.readNote=W,a.replaceNote=P,a.setNoteValue=q,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=rpg-data-tools.umd.js.map
