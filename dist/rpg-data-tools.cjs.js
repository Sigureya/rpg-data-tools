"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const r=require("@sigureya/rpgtypes");function Ze(e){const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const a in e)if(a!=="default"){const n=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,n.get?n:{enumerable:!0,get:()=>e[a]})}}return t.default=e,Object.freeze(t)}const s=Ze(r),E=()=>[0,0,0,0,0,0,0,0],be=e=>({id:0,name:"",nickname:"",profile:"",note:"",classId:0,initialLevel:1,maxLevel:99,characterIndex:0,characterName:"",faceIndex:0,faceName:"",battlerName:"",traits:[],equips:[],...e}),et=e=>({battlerHue:0,id:0,name:"",note:"",battlerName:"",traits:[],params:E(),exp:0,gold:0,dropItems:[],actions:[],...e}),tt=e=>({price:0,id:0,name:"",note:"",iconIndex:0,description:"",etypeId:0,params:E(),traits:[],...e}),at=e=>({price:0,id:0,name:"",note:"",iconIndex:0,description:"",etypeId:0,wtypeId:0,params:E(),traits:[],damage:p(),...e}),nt=e=>({id:0,name:"",note:"",traits:[],learnings:[],params:E(),expParams:[],...e}),p=e=>({type:0,elementId:0,formula:"0",variance:20,critical:!1,...e}),rt=e=>({id:0,name:"",iconIndex:0,description:"",note:"",price:0,consumable:!1,scope:0,occasion:0,speed:0,successRate:100,repeats:1,tpGain:0,hitType:0,animationId:0,damage:p(),effects:[],...e}),st=e=>({animationId:0,damage:p(),description:"",hitType:0,iconIndex:0,id:0,message1:"",message2:"",mpCost:0,name:"",note:"",occasion:0,repeats:1,requiredWtypeId1:0,requiredWtypeId2:0,scope:0,speed:0,stypeId:0,successRate:100,tpCost:0,tpGain:0,effects:[],messageType:0,...e}),ct=e=>({id:0,name:"",iconIndex:0,restriction:0,priority:50,motion:0,overlay:0,removeAtBattleEnd:!1,removeByRestriction:!1,autoRemovalTiming:0,minTurns:1,maxTurns:1,removeByDamage:!1,chanceByDamage:100,removeByWalking:!1,stepsToRemove:100,message1:"",message2:"",message3:"",message4:"",traits:[],note:"",...e}),ot=e=>({autoplayBgm:!0,autoplayBgs:!1,battleback1Name:"",battleback2Name:"",data:[],disableDashing:!1,displayName:"",encounterList:[],events:[],height:0,note:"",width:0,x:0,y:0,parallaxName:"",parallaxLoopX:!1,parallaxLoopY:!1,parallaxShow:!1,parallaxSx:0,parallaxSy:0,...e}),it=e=>({id:0,name:"",note:"",x:0,y:0,pages:[Y()],...e}),k=e=>({actorId:0,actorValid:!1,itemId:0,itemValid:!1,selfSwitchCh:"",selfSwitchValid:!1,switch1Id:0,switch1Valid:!1,switch2Id:0,switch2Valid:!1,variableId:0,variableValid:!1,variableValue:0,...e}),V=e=>({characterIndex:0,characterName:"",direction:6,pattern:0,tileId:0,...e}),Y=e=>({conditions:k(),image:V(),moveRoute:{list:[],repeat:!1,wait:!1,skippable:!1},directionFix:!1,moveFrequency:0,list:[],...e}),i=(e={})=>({name:e.name??"",volume:e.volume??90,pitch:e.pitch??100,pan:e.pan??0}),mt=(e,t,a=0)=>({code:e,parameters:[i({name:t})],indent:a}),At=(e={})=>({local:e.local??"",gameTitle:e.gameTitle??"",currencyUnit:e.currencyUnit??"",title1Name:e.title1Name??"",terms:e.terms??W(),title2Name:e.title2Name??"",optAutosave:e.optAutosave??!1,attackMotions:e.attackMotions??[],startMapId:e.startMapId??0,startX:e.startX??0,startY:e.startY??0,switches:e.switches??[],windowTone:e.windowTone??[0,0,0,0],editMapId:e.editMapId??0,testTroopId:e.testTroopId??0,testBattlers:e.testBattlers??[],versionId:e.versionId??0,advanced:e.advanced??z(),armorTypes:e.armorTypes??[],elements:e.elements??[],variables:e.variables??[],equipTypes:e.equipTypes??[],sounds:e.sounds??x(),titleBgm:e.titleBgm??i(),gameoverMe:e.gameoverMe??i(),battleBgm:e.battleBgm??i(),defeatMe:e.defeatMe??i(),victoryMe:e.victoryMe??i(),battleback1Name:e.battleback1Name??"",battleback2Name:e.battleback2Name??"",battlerName:e.battlerName??"",weaponTypes:e.weaponTypes??[],skillTypes:e.skillTypes??[],optDisplayTp:e.optDisplayTp??!1,optDrawTitle:e.optDrawTitle??!1,optExtraExp:e.optExtraExp??!1,optFloorDeath:e.optFloorDeath??!1,optFollowers:e.optFollowers??!1,optKeyItemsNumber:e.optKeyItemsNumber??!1,optSideView:e.optSideView??!1,optSlipDeath:e.optSlipDeath??!1,optTransparent:e.optTransparent??!1,boat:e.boat??d(),ship:e.ship??d(),airship:e.airship??d(),tileSize:e.tileSize??0}),W=(e={})=>({messages:K(e.messages??{}),commands:X(e.commands??{}),params:U(e.params??{}),basic:F(e.basic??{})}),F=(e={})=>[e.level??"",e.levelA??"",e.hp??"",e.hpA??"",e.mp??"",e.mpA??"",e.tp??"",e.tpA??"",e.experience??"",e.exp??""],U=(e={})=>[e.mhp??"",e.mmp??"",e.atk??"",e.def??"",e.mat??"",e.mdf??"",e.agi??"",e.luk??"",e.hit??"",e.eva??""],X=(e={})=>[e.fight??"",e.escape??"",e.attack??"",e.guard??"",e.item??"",e.skill??"",e.equip??"",e.status??"",e.formation??"",e.save??"",e.gameEnd??"",e.options??"",e.weapon??"",e.armor??"",e.keyItem??"",e.equip2??"",e.optimize??"",e.clear??"",e.newGame??"",e.continue_??"",e.notUsed20??"",e.toTitle??"",e.cancel??"",e.notUsed23??"",e.buy??"",e.sell??""],K=(e={})=>({alwaysDash:e.alwaysDash??"",commandRemember:e.commandRemember??"",touchUI:e.touchUI??"",bgmVolume:e.bgmVolume??"",bgsVolume:e.bgsVolume??"",meVolume:e.meVolume??"",seVolume:e.seVolume??"",possession:e.possession??"",expTotal:e.expTotal??"",expNext:e.expNext??"",saveMessage:e.saveMessage??"",loadMessage:e.loadMessage??"",file:e.file??"",autosave:e.autosave??"",partyName:e.partyName??"",emerge:e.emerge??"",preemptive:e.preemptive??"",surprise:e.surprise??"",escapeStart:e.escapeStart??"",escapeFailure:e.escapeFailure??"",victory:e.victory??"",defeat:e.defeat??"",obtainExp:e.obtainExp??"",obtainGold:e.obtainGold??"",obtainItem:e.obtainItem??"",levelUp:e.levelUp??"",obtainSkill:e.obtainSkill??"",useItem:e.useItem??"",criticalToEnemy:e.criticalToEnemy??"",criticalToActor:e.criticalToActor??"",actorDamage:e.actorDamage??"",actorRecovery:e.actorRecovery??"",actorGain:e.actorGain??"",actorLoss:e.actorLoss??"",actorDrain:e.actorDrain??"",actorNoDamage:e.actorNoDamage??"",actorNoHit:e.actorNoHit??"",enemyDamage:e.enemyDamage??"",enemyRecovery:e.enemyRecovery??"",enemyGain:e.enemyGain??"",enemyLoss:e.enemyLoss??"",enemyDrain:e.enemyDrain??"",enemyNoDamage:e.enemyNoDamage??"",enemyNoHit:e.enemyNoHit??"",evasion:e.evasion??"",magicEvasion:e.magicEvasion??"",magicReflection:e.magicReflection??"",counterAttack:e.counterAttack??"",substitute:e.substitute??"",buffAdd:e.buffAdd??"",debuffAdd:e.debuffAdd??"",buffRemove:e.buffRemove??"",actionFailure:e.actionFailure??""}),z=(e={})=>({gameId:e.gameId??0,screenWidth:e.screenWidth??0,screenHeight:e.screenHeight??0,uiAreaWidth:e.uiAreaWidth??0,uiAreaHeight:e.uiAreaHeight??0,windowOpacity:e.windowOpacity??0,screenScale:e.screenScale??0,numberFontFilename:e.numberFontFilename??"",mainFontFilename:e.mainFontFilename??"",fallbackFonts:e.fallbackFonts??"",fontSize:e.fontSize??0}),d=(e={})=>({bgm:e.bgm??i(),characterIndex:e.characterIndex??0,characterName:e.characterName??"",startMapId:e.startMapId??0,startX:e.startX??0,startY:e.startY??0}),x=(e={})=>[e.cursor??i(),e.ok??i(),e.cancel??i(),e.buzzer??i(),e.equip??i(),e.save??i(),e.load??i(),e.battleStart??i(),e.escape??i(),e.enemyAttack??i(),e.enemyDamage??i(),e.enemyCollapse??i(),e.bossCollapse1??i(),e.bossCollapse2??i(),e.actorDamage??i(),e.actorCollapse??i(),e.playRecovery??i(),e.playMiss??i(),e.playEvasion??i(),e.playMagicEvasion??i(),e.playReflection??i(),e.shop??i(),e.useItem??i(),e.useSkill??i()],l=(e,t)=>t?e===t.code:!1,q="MessageHeader invalid command",ut="Script invalid command",j="Invalid Head",C=e=>typeof e[0]=="string"&&e.length===1,Et=(e,t)=>t?e===t.code&&C(t.parameters):!1,R=(e,t,a)=>{const n=[];for(let o=a;o<t.length;o++){const m=t[o];if(l(e,m)&&C(m.parameters))n.push({code:e,indent:m.indent,parameters:[m.parameters[0]]});else break}return n},h=(e,t,a)=>{const n=e[t];if(n&&l(a,n)&&C(n.parameters))return{code:a,indent:n.indent,parameters:[n.parameters[0]]};throw new Error(j,{cause:n})},$=(e,t)=>({head:h(e,t,r.COMMENT),bodys:R(r.COMMENT_BODY,e,t+1)}),J=(e,t)=>({head:h(e,t,r.SCRIPT_EVAL),bodys:R(r.SCRIPT_EVAL_BODY,e,t+1)}),Q=(e,t)=>{const a=e[t];if(a&&Z(a))return a;throw new Error(q,{cause:a})},Z=e=>!e||e.code!==r.SHOW_MESSAGE||![4,5].includes(e.parameters.length)?!1:typeof e.parameters[0]=="string"&&typeof e.parameters[1]=="number"&&typeof e.parameters[2]=="number"&&typeof e.parameters[3]=="number",b=(e,t)=>({head:Q(e,t),bodys:R(r.SHOW_MESSAGE_BODY,e,t+1)}),ee="ScrollTextHeader invalid command",te=(e,t)=>{const a=e[t];if(l(r.SHOW_SCROLLING_TEXT,a))return a;const n={headCode:r.SHOW_SCROLLING_TEXT,bodyCode:r.SHOW_SCROLLING_TEXT_BODY,index:t};throw new Error(ee,{cause:n})},ae=(e,t)=>({head:te(e,t),bodys:R(r.SHOW_SCROLLING_TEXT_BODY,e,t+1)}),ne=(e,t=`
`)=>e.map(a=>a.parameters[0]).join(t);class g{constructor(t,a){this.header=t,this.bodies=a}getBodyText(t=`
`){return ne(this.getExpandedBodies(),t)}jopinHedderAndBody(){return[this.header,...this.bodies]}joinCommandBodies(){return this.getExpandedBodies()}}class T extends g{constructor(t,a,n){super(a,n),this.bodyCode=t}getExpandedBodies(){return this.bodies}normalizedCommands(){const t={...this.header,code:this.header.code,indent:this.header.indent,parameters:[...this.header.parameters]};return this.bodies.length===0?[t]:[t,this.mergedBody()]}mergedBody(){return{code:this.bodyCode,indent:this.header.indent,parameters:[this.getBodyText()]}}}class M extends g{getExpandedBodies(){return[this.header,...this.bodies]}mergedBody(){return{code:this.header.code,indent:this.header.indent,parameters:[this.getBodyText()]}}normalizedCommands(){return[this.mergedBody()]}}const re="選択肢ヘルプ",se=e=>e.parameters[0]===re,ce=(e,t=[])=>new T(401,e,t),oe=(e,t=[])=>new T(405,e,t),ie=(e,t=[])=>se(e)?new T(408,e,t):new M(e,t),me=(e,t=[])=>new M(e,t),P=(e,t,a)=>{const n=b(e,t),o=ce(n.head,n.bodys);return a(o)},I=(e,t,a)=>{const n=ae(e,t),o=oe(n.head,n.bodys);return a(o)},N=(e,t,a)=>{const n=$(e,t),o=ie(n.head,n.bodys);return a(o)},f=(e,t,a)=>{const n=J(e,t),o=me(n.head,n.bodys);return a(o)},Ae=(e,t,a)=>{const n=e[t];switch(n.code){case r.SHOW_MESSAGE:return P(e,t,a.showMessage);case r.SHOW_SCROLLING_TEXT:return I(e,t,a.showScrollingText);case r.COMMENT:return N(e,t,a.comment);case r.SCRIPT_EVAL:return f(e,t,a.script);case r.SHOW_CHOICES:return a.showChoices(n,t,e);case r.SHOW_CHOICES_ITEM:return a.choiceWhen(n,t,e);case r.CHANGE_NAME:return a.changeName(n,t,e);case r.CHANGE_PROFILE:return a.changeProfile(n,t,e);case r.CHANGE_NICKNAME:return a.changeNickname(n,t,e);default:return a.other(n,t,e)}},Rt=(e,t)=>e.map((a,n,o)=>Ae(o,n,t)),c=(e,t,a,n,o)=>n?n(e,t,a):o(e,t,a),ue=(e,t)=>e.map((a,n)=>L(e,n,t)),_t=(e,t)=>e.flatMap((a,n)=>L(e,n,t)),L=(e,t,a)=>{const n=e[t];switch(n.code){case s.SHOW_MESSAGE:return a.showMessage?P(e,t,a.showMessage):a.other(n,t,e);case s.SHOW_MESSAGE_BODY:return c(n,t,e,a.showMessageBody,a.other);case s.SHOW_SCROLLING_TEXT:return a.showScrollingText?I(e,t,a.showScrollingText):a.other(n,t,e);case s.SHOW_SCROLLING_TEXT_BODY:return c(n,t,e,a.showScrollingTextBody,a.other);case s.SHOW_CHOICES:return c(n,t,e,a.showChoices,a.other);case s.SHOW_CHOICES_ITEM:return c(n,t,e,a.choiceWhen,a.other);case s.COMMENT:return a.comment?N(e,t,a.comment):a.other(n,t,e);case s.COMMENT_BODY:return c(n,t,e,a.commentBody,a.other);case s.SCRIPT_EVAL:return a.script?f(e,t,a.script):a.other(n,t,e);case s.SCRIPT_EVAL_BODY:return c(n,t,e,a.scriptBody,a.other);case s.CONDITIONAL_BRANCH:return c(n,t,e,a.conditionalBranch,a.other);case s.CONTROL_SWITCHES:return c(n,t,e,a.controlSwitch,a.other);case s.CONTROL_VARIABLES:return c(n,t,e,a.controlVariable,a.other);case s.CONTROL_SELF_SWITCH:return c(n,t,e,a.controlSelfSwitch,a.other);case s.CONTROL_TIMER:return c(n,t,e,a.controlTimer,a.other);case s.COMMON_EVENT:return c(n,t,e,a.commonEvent,a.other);case s.CHANGE_SAVE_ACCESS:return c(n,t,e,a.changeSaveAccess,a.other);case s.CHANGE_MENU_ACCESS:return c(n,t,e,a.changeMenuAccess,a.other);case s.CHANGE_ENCOUNTER:return c(n,t,e,a.changeEncounter,a.other);case s.CHANGE_FORMATION_ACCESS:return c(n,t,e,a.changeFormationAccess,a.other);case s.CHANGE_NAME:return c(n,t,e,a.changeName,a.other);case s.CHANGE_PROFILE:return c(n,t,e,a.changeProfile,a.other);case s.CHANGE_NICKNAME:return c(n,t,e,a.changeNickname,a.other);case s.CHANGE_ACTOR_IMAGES:return c(n,t,e,a.changeActorImages,a.other);case s.CHANGE_VEHICLE_IMAGE:return c(n,t,e,a.changeVehicleImage,a.other);case s.CHANGE_BATTLE_BGM:return c(n,t,e,a.changeBattleBGM,a.other);case s.CHANGE_VICTORY_ME:return c(n,t,e,a.changeVictoryME,a.other);case s.CHANGE_DEFEAT_ME:return c(n,t,e,a.changeDefeatME,a.other);case s.PLAY_BGM:return c(n,t,e,a.playBGM,a.other);case s.FADEOUT_BGM:return c(n,t,e,a.fadeOutBGM,a.other);case s.PLAY_SE:return c(n,t,e,a.playSE,a.other);case s.STOP_SE:return c(n,t,e,a.stopSE,a.other);case s.PLAY_ME:return c(n,t,e,a.playME,a.other);case s.LABEL:return c(n,t,e,a.label,a.other);case s.LABEL_JUMP:return c(n,t,e,a.labelJump,a.other);case s.CHANGE_WINDOW_COLOR:return c(n,t,e,a.changeWindowColor,a.other);case s.TINT_SCREEN:return c(n,t,e,a.tintScreen,a.other);case s.FLASH_SCREEN:return c(n,t,e,a.flashScreen,a.other);case s.SHAKE_SCREEN:return c(n,t,e,a.shakeScreen,a.other);case s.SHOW_PICTURE:return c(n,t,e,a.showPicture,a.other);case s.MOVE_PICTURE:return c(n,t,e,a.movePicture,a.other);case s.ROTATE_PICTURE:return c(n,t,e,a.rotatePicture,a.other);case s.TINT_PICTURE:return c(n,t,e,a.tintPicture,a.other);case s.ERASE_PICTURE:return c(n,t,e,a.erasePicture,a.other);case s.BATTLE_PROCESSING:return c(n,t,e,a.battleProcessing,a.other);case s.WAIT:return c(n,t,e,a.wait,a.other);case s.GAME_OVER:return c(n,t,e,a.gameover,a.other);case s.CHANGE_PARALLAX:return c(n,t,e,a.changeParallax,a.other);case s.CHANGE_BATTLE_BACKGROUND:return c(n,t,e,a.changeBattleBackground,a.other);case s.PLAY_MOVIE:return c(n,t,e,a.playMovie,a.other);case s.CHANGE_TRANSPARENCY:return c(n,t,e,a.changeTransparency,a.other);case s.SET_WEATHER_EFFECT:return c(n,t,e,a.setWeatherEffects,a.other);case s.CHANGE_GOLD:return c(n,t,e,a.changeGold,a.other);case s.SHOW_ANIMATION:return c(n,t,e,a.showAnimation,a.other);case s.TRANSFER_PLAYER:return c(n,t,e,a.transferPlayer,a.other);case s.SET_VEHICLE_LOCATION:return c(n,t,e,a.setVehicleLocation,a.other);case s.SET_EVENT_LOCATION:return c(n,t,e,a.setEventLocation,a.other);default:return a.other(n,t,e)}},dt={commentBody:()=>[],showMessageBody:()=>[],scriptBody:()=>[],showScrollingTextBody:()=>[],showMessage:e=>e.normalizedCommands(),showScrollingText:e=>e.normalizedCommands(),comment:e=>e.normalizedCommands(),script:e=>e.normalizedCommands(),other:e=>[e]},S=e=>ue(e,dt),pt=e=>!!e,lt=(e,t,a)=>({data:e,eventId:t,pageIndex:a}),Ee=(e,t,a)=>e.list.map(n=>({data:n,eventId:a.id,pageIndex:t})),O=(e,t)=>e.pages.map((a,n)=>t(a,n,e)),v=(e,t)=>e.events.filter(pt).map(a=>O(a,t)),Ct=(e,t)=>v(e,t).flat(2),Tt=(e,t)=>e.map(a=>O(a,t)),St=(e,t)=>e.map(a=>t(a,0,a)),ht=e=>v(e,Ee).flat(2),G=(e,t)=>{const a=t(e.list);return{...e,list:a}},H=(e,t)=>({...e,pages:e.pages.map(a=>G(a,t))}),Re=(e,t)=>({...e,events:e.events.map(a=>a?H(a,t):null)}),_e=(e,t)=>e.map(a=>G(a,t)),de=(e,t)=>e.map(a=>H(a,t)),gt=e=>Re(e,t=>S(t).flat()),Mt=e=>_e(e,t=>S(t).flat()),Pt=e=>de(e,t=>S(t).flat()),D=(e,t)=>t.includes(e.code),It=e=>D(e,Nt),Nt=[s.PLAY_BGM,s.PLAY_BGS,s.PLAY_ME,s.PLAY_SE,s.CHANGE_BATTLE_BGM,s.CHANGE_VICTORY_ME,s.CHANGE_DEFEAT_ME,s.CHANGE_VEHICLE_BGM],ft=e=>D(e,Lt),Lt=[s.SHOW_MESSAGE,s.SHOW_PICTURE,s.CHANGE_ACTOR_IMAGES,s.CHANGE_VEHICLE_IMAGE,s.CHANGE_PARALLAX,s.CHANGE_BATTLE_BACKGROUND],Ot=(e,t)=>({code:e.code,paramIndex:t,value:e.parameters[t]}),vt=(e,t)=>({code:e.code,paramIndex:t,value:e.parameters[t]}),Gt=(e,t)=>({code:e.code,paramIndex:t,value:e.parameters[t]}),Ht=(e,t,a=0)=>({code:e,indent:a,parameters:t}),y=(e,t)=>`<${e}:${t}>`,_=()=>/<([^<>:]+):([^>]*)>/g,Dt=(e,t)=>B(e.note,(a,n)=>t(a,n,e)),yt=e=>B(e,(t,a)=>[t,a]),B=(e,t)=>{const a=_(),n=[];let o;for(;(o=a.exec(e))!==null;)n.push(t(o[1],o[2]));return n},Bt=(e,t)=>e.replace(_(),(a,n,o)=>{const m=t(n,o);return y(n,m)}),wt=(e,t)=>{const a=_();let n;for(;(n=a.exec(e))!==null;)if(n[1]===t)return n[2]},kt=(e,t,a)=>{const n=_();return e.replace(n,(o,m)=>m===t?y(m,a):o)},Vt=e=>`code:${e}`,Yt="N",Wt="V",w=(e,t)=>`\\${e}[${t}]`,pe=e=>w(Yt,e.id),Ft=e=>e.map(t=>({controlChar:pe(t),text:t.name})),Ut=e=>e.variables.map((t,a)=>({text:t||"",controlChar:w(Wt,a)})).filter(t=>t.text!==""),Xt=new Set(["px","py","x","y","v","n","p","g","c","i","fs"]),Kt=(e,t=Xt)=>{const a=/\\([A-Za-z]+)\[(\d+)]/g,n=[];let o;for(;(o=a.exec(e))!==null;){const m=o[1].toLowerCase(),Qe=parseInt(o[2],10);t.has(m)&&n.push({char:o[1],id:Qe})}return n},le=(e,t,a)=>t.map(n=>a(n,e[n],e)),zt=(e,t,a)=>le(e,t,a),u=(e,t)=>({name:e,id:t}),Ce=e=>e.variables.map(u),Te=e=>e.elements.map(u),Se=e=>e.equipTypes.map(u),he=e=>e.skillTypes.map(u),ge=e=>e.weaponTypes.map(u),Me=e=>e.armorTypes.map(u),xt=e=>e.terms.params.map(u),qt=(e,t)=>{switch(e){case r.REGULAR_PARAM_MAX_HP:return t.maxHp;case r.REGULAR_PARAM_MAX_MP:return t.maxMp;case r.REGULAR_PARAM_ATK:return t.atk;case r.REGULAR_PARAM_DEF:return t.def;case r.REGULAR_PARAM_MATK:return t.matk;case r.REGULAR_PARAM_MDEF:return t.mdef;case r.REGULAR_PARAM_AGI:return t.agi;case r.REGULAR_PARAM_LUK:return t.luk;default:return`?rparams[${e}]`}},jt=(e,t)=>{switch(e){case r.EXTRA_PARAM_CEV:return t.criticalEvasionRate;case r.EXTRA_PARAM_EVA:return t.evasionRate;case r.EXTRA_PARAM_CNT:return t.counterAttackRate;case r.EXTRA_PARAM_CRI:return t.criticalRate;case r.EXTRA_PARAM_HIT:return t.hitRate;case r.EXTRA_PARAM_HRG:return t.hpRegenerationRate;case r.EXTRA_PARAM_MEV:return t.magicEvasionRate;case r.EXTRA_PARAM_MRF:return t.magicReflectionRate;case r.EXTRA_PARAM_MRG:return t.mpRegenerationRate;case r.EXTRA_PARAM_TRG:return t.tpRegenerationRate}return`?xparams[${e}]`},$t=(e,t)=>{switch(e){case r.SPECIAL_PARAM_EXR:return t.experienceRate;case r.SPECIAL_PARAM_TGR:return t.targetRate;case r.SPECIAL_PARAM_FDR:return t.floorDamageRate;case r.SPECIAL_PARAM_GRD:return t.guradEffectRate;case r.SPECIAL_PARAM_MCR:return t.mpCostRate;case r.SPECIAL_PARAM_TCR:return t.tpChargeRate;case r.SPECIAL_PARAM_PDR:return t.physicalDamageRate;case r.SPECIAL_PARAM_MDR:return t.magicDamageRate;case r.SPECIAL_PARAM_PHA:return t.pharmacology;case r.SPECIAL_PARAM_REC:return t.recoveryEffectRate}return`?sparams[${e}]`},Pe=(e,t)=>[{id:r.COLLAPS_NORMAL,name:t.normal},{id:r.COLLAPS_BOSS,name:e.bossCollaps},{id:r.COLLAPS_INSTANT,name:e.instantCollaps},{id:r.COLLAPS_NONE,name:e.noneCollaps}],Ie=e=>[{id:r.PARTY_ABILITY_ENCOUNTER_HALF,name:e.encounterHalf},{id:r.PARTY_ABILITY_ENCOUNTER_NONE,name:e.encounterNone},{id:r.PARTY_ABILITY_CANCEL_SURPRISE,name:e.cancelSurprise},{id:r.PARTY_ABILITY_RAISE_PREEMPTIVE,name:e.raisePreemptive},{id:r.PARTY_ABILITY_GOLD_DOUBLE,name:e.goldDouble},{id:r.PARTY_ABILITY_DROP_ITEM_DOUBLE,name:e.dropItemDouble}],Ne=e=>[{id:r.REGULAR_PARAM_MAX_HP,name:e.maxHp},{id:r.REGULAR_PARAM_MAX_MP,name:e.maxMp},{id:r.REGULAR_PARAM_ATK,name:e.atk},{id:r.REGULAR_PARAM_DEF,name:e.def},{id:r.REGULAR_PARAM_MATK,name:e.matk},{id:r.REGULAR_PARAM_MDEF,name:e.mdef},{id:r.REGULAR_PARAM_AGI,name:e.agi},{id:r.REGULAR_PARAM_LUK,name:e.luk}],fe=e=>[{id:r.EXTRA_PARAM_HIT,name:e.hitRate},{id:r.EXTRA_PARAM_EVA,name:e.evasionRate},{id:r.EXTRA_PARAM_CRI,name:e.criticalRate},{id:r.EXTRA_PARAM_CEV,name:e.criticalEvasionRate},{id:r.EXTRA_PARAM_MEV,name:e.magicEvasionRate},{id:r.EXTRA_PARAM_MRF,name:e.magicReflectionRate},{id:r.EXTRA_PARAM_CNT,name:e.counterAttackRate},{id:r.EXTRA_PARAM_HRG,name:e.hpRegenerationRate},{id:r.EXTRA_PARAM_MRG,name:e.mpRegenerationRate},{id:r.EXTRA_PARAM_TRG,name:e.tpRegenerationRate}],Le=e=>[{id:r.SPECIAL_PARAM_TGR,name:e.targetRate},{id:r.SPECIAL_PARAM_GRD,name:e.guradEffectRate},{id:r.SPECIAL_PARAM_REC,name:e.recoveryEffectRate},{id:r.SPECIAL_PARAM_PHA,name:e.pharmacology},{id:r.SPECIAL_PARAM_MCR,name:e.mpCostRate},{id:r.SPECIAL_PARAM_TCR,name:e.tpChargeRate},{id:r.SPECIAL_PARAM_PDR,name:e.physicalDamageRate},{id:r.SPECIAL_PARAM_MDR,name:e.magicDamageRate},{id:r.SPECIAL_PARAM_FDR,name:e.floorDamageRate},{id:r.SPECIAL_PARAM_EXR,name:e.experienceRate}],Oe="params",ve="xparams",Ge="sparams",He="collaps",De="partyAbiility",ye="sflag",Be="actors",we="variables",Jt="map",ke="enemy",Ve="state",Ye="skill",We="items",Fe="weapon",Ue="armor",Xe="class",Ke="common_event",ze="troop",Qt="colors",xe="weaponTypes",qe="armorTypes",je="equipTypes",Zt="switches",$e="skillTypes",Je="elements",bt=(e,t)=>({armorTypes:{items:Me(e),sourceKey:qe,label:t.armorTypes},elements:{items:Te(e),sourceKey:Je,label:t.elements},equipTypes:{items:Se(e),sourceKey:je,label:t.equipTypes},skillTypes:{items:he(e),sourceKey:$e,label:t.equipTypes},variables:{items:Ce(e),sourceKey:we,label:t.variables},weaponTypes:{items:ge(e),sourceKey:xe,label:t.weaponTypes}}),A=e=>e.map(t=>({id:t.id,name:t.name})),ea=(e,t)=>({actors:{items:A(e.actors),sourceKey:Be,label:t.actors.domainName},armors:{items:A(e.armors),sourceKey:Ue,label:t.armors.domainName},classes:{items:A(e.classes),sourceKey:Xe,label:t.classes.domainName},commonEvents:{items:A(e.commonEvents),sourceKey:Ke,label:t.commonEvents.domainName},enemies:{items:A(e.enemies),sourceKey:ke,label:t.enemies.domainName},items:{items:A(e.items),sourceKey:We,label:t.items.domainName},skills:{items:A(e.skills),sourceKey:Ye,label:t.items.domainName},states:{items:A(e.states),sourceKey:Ve,label:t.states.domainName},troops:{items:A(e.troops),sourceKey:ze,label:t.troops.domainName},weapons:{items:A(e.weapons),sourceKey:Fe,label:t.weapons.domainName}}),ta=(e,t)=>({paramRegular:{sourceKey:Oe,label:t.types.regularParam,items:Ne(t.options.paramRegular)},paramExtra:{sourceKey:ve,label:t.types.extraParam,items:fe(t.options.paramExtra)},paramSpecial:{sourceKey:Ge,label:t.types.specialParam,items:Le(t.options.paramSpecial)},collaps:{sourceKey:He,label:t.types.collapseType,items:Pe(t.options.collaps,e)},partyAbility:{sourceKey:De,label:t.types.partyAbility,items:Ie(t.options.partyAbility)},specialFlag:{sourceKey:ye,label:t.types.specialFlag,items:[]}}),aa=(e,t,a)=>{const n=bt(t,e.system),o=ta(e.global,e.trait),m=ea(a,e.domains);return[n.armorTypes,n.elements,n.equipTypes,n.skillTypes,n.variables,n.weaponTypes,o.collaps,o.paramExtra,o.paramRegular,o.paramSpecial,o.partyAbility,o.specialFlag,m.actors,m.armors,m.classes,m.commonEvents,m.enemies,m.items,m.skills,m.states,m.troops,m.weapons]};exports.BaseEventCommandGroup=g;exports.CHOICE_HELP_TEXT=re;exports.CombinedEventCommandGroup=M;exports.ERROR_COMMAND_MESSAGE=q;exports.ERROR_COMMAND_SCRIPT=ut;exports.ERROR_INVALID_HEAD=j;exports.ERROR_MESSAGE=ee;exports.SRC_ARMOR_TYPES=qe;exports.SRC_COLOR=Qt;exports.SRC_COMMON_EVNET=Ke;exports.SRC_DATA_ACTOR=Be;exports.SRC_DATA_ARMOR=Ue;exports.SRC_DATA_CLASS=Xe;exports.SRC_DATA_ENEMY=ke;exports.SRC_DATA_ITEMS=We;exports.SRC_DATA_MAP=Jt;exports.SRC_DATA_SKILL=Ye;exports.SRC_DATA_STATE=Ve;exports.SRC_DATA_VARIABLE=we;exports.SRC_DATA_WEAPON=Fe;exports.SRC_ELEMENTS=Je;exports.SRC_EQUIP_TYPES=je;exports.SRC_PARAMS_EXTRA=ve;exports.SRC_PARAMS_REGULAR=Oe;exports.SRC_PARAMS_SPECIAL=Ge;exports.SRC_SKILL_TYPES=$e;exports.SRC_SWITCHES=Zt;exports.SRC_TRAIT_COLLAPS=He;exports.SRC_TRAIT_PARTY_ABILITY=De;exports.SRC_TRAIT_SPECIAL_FLAG=ye;exports.SRC_TROOP=ze;exports.SRC_WEAPON_TYPES=xe;exports.SimpleEventCommandGroup=T;exports.callHandler=c;exports.codeInfoText=Vt;exports.codeTest=l;exports.collectMapEvents=Ct;exports.constructActor=be;exports.constructArmor=tt;exports.constructClass=nt;exports.constructDamage=p;exports.constructEnemy=et;exports.constructItem=rt;exports.constructParamArray=E;exports.constructSkill=st;exports.constructState=ct;exports.constructWeapon=at;exports.createAdvanced=z;exports.createAudio=i;exports.createAudioCommand=mt;exports.createBasicTerms=F;exports.createCommandContext=Ee;exports.createCommandsArray=X;exports.createCommentGroup=ie;exports.createCondtion=k;exports.createControlCharFormat=w;exports.createEventCommand=Ht;exports.createEventContext=lt;exports.createEventPage=Y;exports.createMap=ot;exports.createMapEvent=it;exports.createMapEventImage=V;exports.createMessageGroup=ce;exports.createMessages=K;exports.createNoteEntity=y;exports.createParamNamesArray=U;exports.createScriptGroup=me;exports.createScrlloingTextGroup=oe;exports.createSystemData=At;exports.createSystemSoundsArray=x;exports.createTerms=W;exports.createVehicle=d;exports.extraParamName=jt;exports.flatMappingCommandList=_t;exports.foldCollapsOptions=Pe;exports.foldExtraParam=fe;exports.foldPartyAbilityOptions=Ie;exports.foldRegularParam=Ne;exports.foldSpecialParams=Le;exports.fromActor=pe;exports.fromActors=Ft;exports.fromSystem=Ut;exports.gatherEventCommandContext=ht;exports.getArmorTypes=Me;exports.getControlChars=Kt;exports.getElements=Te;exports.getEquipTypes=Se;exports.getNoteValue=wt;exports.getParamNames=xt;exports.getSkillTypes=he;exports.getVariableNames=Ce;exports.getWeaponTypes=ge;exports.handleGroupComment=N;exports.handleGroupMessage=P;exports.handleGroupScript=f;exports.handleGroupScrollingText=I;exports.handlerDispatch=Ae;exports.isAudioCommand=It;exports.isBodyParams=C;exports.isChoiceHelp=se;exports.isHeadCommand=Et;exports.isImageCommand=ft;exports.isMessageHeader=Z;exports.joinCommandBodies=ne;exports.makeRegex=_;exports.mapTextCommand=Rt;exports.mappingCommand=L;exports.mappingCommandList=ue;exports.matchesEventCommand=D;exports.namedItems=aa;exports.normalizedCommands=S;exports.normalizedCommonEvents=Mt;exports.normalizedMapData=gt;exports.normalizedTroops=Pt;exports.pickCommandParamAudio=Gt;exports.pickCommandParamNumber=vt;exports.pickCommandParamString=Ot;exports.pickCommands=R;exports.pickComments=$;exports.pickHead=h;exports.pickMessageHeader=Q;exports.pickMessageWithHead=b;exports.pickPropertys=le;exports.pickScripts=J;exports.pickScrollText=ae;exports.pickScrollTextHeader=te;exports.pickString=zt;exports.processCommonEvents=St;exports.processEventPages=O;exports.processMapEvents=v;exports.processTroopEvents=Tt;exports.readNote=yt;exports.readNoteEx=B;exports.readNoteObject=Dt;exports.regularParamName=qt;exports.replaceCommonEvents=_e;exports.replaceEventCommands=G;exports.replaceMapEvents=Re;exports.replaceNote=Bt;exports.replacePages=H;exports.replaceTroops=de;exports.setNoteValue=kt;exports.specialParamName=$t;
//# sourceMappingURL=rpg-data-tools.cjs.js.map
